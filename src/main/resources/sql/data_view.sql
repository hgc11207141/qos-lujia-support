/*
Navicat MySQL Data Transfer

Source Server         : 10.9.1.42
Source Server Version : 50537
Source Host           : 10.9.1.42:3306
Source Database       : qos

Target Server Type    : MYSQL
Target Server Version : 50537
File Encoding         : 65001

Date: 2019-12-11 09:59:14
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for data_view
-- ----------------------------
DROP TABLE IF EXISTS `data_view`;
CREATE TABLE `data_view` (
  `id` varchar(20) NOT NULL,
  `name` varchar(200) NOT NULL COMMENT '名称',
  `origin_data_source` varchar(30) NOT NULL COMMENT '原始数据源',
  `target_data_source` varchar(30) NOT NULL,
  `select_sql` text NOT NULL COMMENT '查询sql',
  `filing_strategy` tinyint(4) NOT NULL COMMENT '归档策略',
  `filing_strategy_param1` int(11) DEFAULT NULL COMMENT '归档策略参数1，配合数据归档策略用',
  `filing_strategy_param2` varchar(500) DEFAULT NULL COMMENT '归档策略参数2，配合数据归档策略用',
  `schedule_strategy` tinyint(4) NOT NULL,
  `schedule_strategy_param1` int(11) DEFAULT NULL,
  `schedule_strategy_param2` varchar(500) DEFAULT NULL,
  `schedule_hour` int(11) NOT NULL DEFAULT '19',
  `execute_hours` int(11) NOT NULL DEFAULT '10',
  `real_time_enabled` tinyint(4) NOT NULL DEFAULT '0' COMMENT '是否需要实时',
  `real_time_interval` smallint(6) NOT NULL DEFAULT '5' COMMENT '实时间隔，分钟',
  `notes` varchar(500) DEFAULT NULL COMMENT '备注',
  `enabled` tinyint(4) NOT NULL COMMENT '是否启用',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of data_view
-- ----------------------------
INSERT INTO `data_view` VALUES ('V20001', '总数，残疾人数，高血压数，糖尿病数，孕产妇数，0-6岁儿童签约数，65岁以上老年人，严重肺结核，精神障碍，离休干部数，疾病筛查数', 'gongwei', 'local', 'select t.MANAGEDCENTERCODE,t.total,cjr.cjrs,gxy.gxys,tnb.tnbs,ycf.ycfs,etqy.etqys,lnr.lnrs,fjh.fjhs,jsza.jszas,gb.gbs,jbsc.jbscs from\r\n\r\n(select MANAGEDCENTERCODE,count(1) as total from phis_chss.v_fha_person_main\r\nwhere MANAGEDCENTERCODE is not null\r\nand stateid = \'1\'\r\ngroup by MANAGEDCENTERCODE) t\r\n\r\nleft join \r\n(select b.MANAGEDCENTERCODE,count(a.CHID) as cjrs from phis_chss.v_fha_person_sign_main a left join phis_chss.v_fha_person_main b\r\non a.code = b.code and b.stateid = \'1\'\r\nWHERE a.signmemtype like \'%B%\'\r\nand a.STATUS = \'1\'\r\nand a.stateid = \'0\'\r\nand a.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\ngroup by b.MANAGEDCENTERCODE) cjr  on t.MANAGEDCENTERCODE = cjr.MANAGEDCENTERCODE\r\n\r\nleft join \r\n(select b.MANAGEDCENTERCODE,count(a.CHID) as gxys from phis_chss.v_fha_person_sign_main a left join phis_chss.v_fha_person_main b\r\non a.code = b.code and b.stateid = \'1\'\r\nWHERE a.signmemtype like \'%5%\'\r\nand a.STATUS = \'1\'\r\nand a.stateid = \'0\'\r\nand a.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\ngroup by b.MANAGEDCENTERCODE) gxy  on t.MANAGEDCENTERCODE = gxy.MANAGEDCENTERCODE\r\n\r\nleft join \r\n(select b.MANAGEDCENTERCODE,count(a.CHID) as tnbs from phis_chss.v_fha_person_sign_main a left join phis_chss.v_fha_person_main b\r\non a.code = b.code and b.stateid = \'1\'\r\nWHERE a.signmemtype like \'%6%\'\r\nand a.STATUS = \'1\'\r\nand a.stateid = \'0\'\r\nand a.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\ngroup by b.MANAGEDCENTERCODE) tnb  on t.MANAGEDCENTERCODE = tnb.MANAGEDCENTERCODE\r\n\r\nleft join \r\n(select b.MANAGEDCENTERCODE,count(a.CHID) as ycfs from phis_chss.v_fha_person_sign_main a left join phis_chss.v_fha_person_main b\r\non a.code = b.code and b.stateid = \'1\'\r\nWHERE a.signmemtype like \'%E%\'\r\nand a.STATUS = \'1\'\r\nand a.stateid = \'0\'\r\nand a.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\ngroup by b.MANAGEDCENTERCODE) ycf  on t.MANAGEDCENTERCODE = ycf.MANAGEDCENTERCODE\r\n\r\nleft join \r\n(select b.MANAGEDCENTERCODE,count(a.CHID) as etqys from phis_chss.v_fha_person_sign_main a left join phis_chss.v_fha_person_main b\r\non a.code = b.code and b.stateid = \'1\'\r\nWHERE a.signmemtype like \'%F%\'\r\nand a.STATUS = \'1\'\r\nand a.stateid = \'0\'\r\nand a.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\ngroup by b.MANAGEDCENTERCODE) etqy  on t.MANAGEDCENTERCODE = etqy.MANAGEDCENTERCODE\r\n\r\nleft join \r\n(select b.MANAGEDCENTERCODE,count(a.CHID) as lnrs from phis_chss.v_fha_person_sign_main a left join phis_chss.v_fha_person_main b\r\non a.code = b.code  and b.stateid = \'1\'\r\nWHERE a.signmemtype like \'%7%\'\r\nand a.STATUS = \'1\'\r\nand a.stateid = \'0\'\r\nand a.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\ngroup by b.MANAGEDCENTERCODE) lnr  on t.MANAGEDCENTERCODE = lnr.MANAGEDCENTERCODE\r\n\r\nleft join \r\n(select b.MANAGEDCENTERCODE,count(a.CHID) as fjhs from phis_chss.v_fha_person_sign_main a left join phis_chss.v_fha_person_main b\r\non a.code = b.code and b.stateid = \'1\'\r\nWHERE a.signmemtype like \'%8%\'\r\nand a.STATUS = \'1\'\r\nand a.stateid = \'0\'\r\nand a.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\ngroup by b.MANAGEDCENTERCODE) fjh  on t.MANAGEDCENTERCODE = fjh.MANAGEDCENTERCODE\r\n\r\nleft join \r\n(select b.MANAGEDCENTERCODE,count(a.CHID) as jszas from phis_chss.v_fha_person_sign_main a left join phis_chss.v_fha_person_main b\r\non a.code = b.code and b.stateid = \'1\'\r\nWHERE a.signmemtype like \'%D%\'\r\nand a.STATUS = \'1\'\r\nand a.stateid = \'0\'\r\nand a.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\ngroup by b.MANAGEDCENTERCODE) jsza  on t.MANAGEDCENTERCODE = jsza.MANAGEDCENTERCODE\r\n\r\n\r\nleft join \r\n(select b.MANAGEDCENTERCODE,count(a.CHID) as gbs from phis_chss.v_fha_person_sign_main a left join phis_chss.v_fha_person_main b\r\non a.code = b.code and b.stateid = \'1\'\r\nWHERE a.signmemtype like \'%G%\'\r\nand a.STATUS = \'1\'\r\nand a.stateid = \'0\'\r\nand a.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\ngroup by b.MANAGEDCENTERCODE) gb  on t.MANAGEDCENTERCODE = gb.MANAGEDCENTERCODE\r\n\r\nleft join \r\n\r\n(select b.MANAGEDCENTERCODE, count(1) as jbscs from phis_chss.v_fha_person_sign_main m\r\nleft join phis_chss.v_fha_person_main b on m.CODE=b.CODE and b.stateid = \'1\'\r\nleft join phis_chss.v_fha_pre_scale_assess a on m.CODE=a.CODE\r\nwhere  m.STATUS = \'1\'\r\nand m.stateid = \'0\'\r\nand m.LASTFLAG = \'1\'\r\nand b.MANAGEDCENTERCODE is not null\r\n and   a.RISKDESC is not null group by b.MANAGEDCENTERCODE) jbsc on t.MANAGEDCENTERCODE = jbsc.MANAGEDCENTERCODE', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V21001', '总数', 'gongwei', 'local', 'SELECT managedcentercode as unit ,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   \r\n        ps.stateid = \'0\' \r\n        AND ps.STATUS = \'1\'  \r\n        GROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21002', '残疾人数（按年份）', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   ps.signmemtype like \'%B%\'\r\n        and ps.stateid = \'0\' \r\n       \r\n        AND ps.STATUS = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21003', '高血压患者（按年份）', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   ps.signmemtype like \'%5%\'\r\n        and ps.stateid = \'0\' \r\n       \r\n        AND ps.STATUS = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21004', '糖尿病患者（按年份） ', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   ps.signmemtype like \'%6%\'\r\n        and ps.stateid = \'0\' \r\n        \r\n        AND ps.STATUS = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21005', '孕产妇（按年份）', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   ps.signmemtype like \'%E%\'\r\n        and ps.stateid = \'0\' \r\n        \r\n        AND ps.STATUS = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21006', '0-6周岁儿童（按年份） ', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   ps.signmemtype like \'%F%\'\r\n        and ps.stateid = \'0\' \r\n         \r\n        AND ps.STATUS = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21007', '65周岁以上老年人（按年份）', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   ps.signmemtype like \'%7%\'\r\n        and ps.stateid = \'0\' \r\n        \r\n        AND ps.STATUS = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21008', '严重精神障碍患者（按年份） ', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   ps.signmemtype like \'%D%\'\r\n        and ps.stateid = \'0\' \r\n        \r\n        AND ps.STATUS = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21009', '肺结核患者（按年份） ', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   ps.signmemtype like \'%8%\'\r\n        and ps.stateid = \'0\' \r\n        \r\n        AND ps.STATUS = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21010', '疾病筛查高危人员（按年份）', 'gongwei', 'local', 'select b.MANAGEDCENTERCODE as unit,to_char( m.SIGNPERIODFROM,\'yyyy\')as year, count(1) as count from phis_chss.v_fha_person_sign_main m\r\nleft join phis_chss.v_fha_person_main b on m.CODE=b.CODE and b.stateid = \'1\'\r\nleft join phis_chss.v_fha_pre_scale_assess a on m.CODE=a.CODE\r\nwhere  m.STATUS = \'1\'\r\nand m.stateid = \'0\'\r\n\r\nand b.MANAGEDCENTERCODE is not null\r\n and   a.RISKDESC is not null group by b.MANAGEDCENTERCODE,to_char( m.SIGNPERIODFROM,\'yyyy\')', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V21011', '离休干部（按年份）', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        right JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE  AND pm.stateid = \'1\'\r\n        WHERE   ps.signmemtype like \'%G%\'\r\n        and ps.stateid = \'0\' \r\n        \r\n        AND ps.STATUS = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')\r\n', '1', null, '', '1', null, '', '19', '10', '0', '5', '', '1');
INSERT INTO `data_view` VALUES ('V30001', '健康档案建档率(总数，建档数，单位)', 'local', 'local', 'select t.MANAGEDCENTERCODE,t.total as TOTAL,jd.jds as JDS FROM\r\n(SELECT a.population as total,b.gongwei_code as MANAGEDCENTERCODE FROM `family_doctor_unit` a left join  data_unit b\r\non a.id = b.id) t\r\n \r\nleft join \r\n(select a.MANAGEDCENTERCODE,count(1) as jds from g_fha_person_main a\r\nwhere a.stateid = \'1\'  \r\ngroup by a.MANAGEDCENTERCODE) jd  on t.MANAGEDCENTERCODE = jd.MANAGEDCENTERCODE', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30002', '\r\n健康档案公开率', 'gongwei', 'local', 'select t.MANAGEDCENTERCODE,t.total,pub.publicnum from \r\n(select MANAGEDCENTERCODE,count(1) as total from phis_chss.v_fha_person_main\r\nwhere stateid = \'1\'\r\nand status = \'1\'\r\nand MANAGEDCENTERCODE is not null\r\ngroup by MANAGEDCENTERCODE ) t\r\n\r\nleft join \r\n(select MANAGEDCENTERCODE,count(1) as publicnum from phis_chss.v_fha_person_main\r\n where stateid = \'1\'and status = \'1\'\r\nand verify=\'1\'\r\ngroup by MANAGEDCENTERCODE) pub on t.MANAGEDCENTERCODE = pub.MANAGEDCENTERCODE', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30003', '老年人体检率', 'gongwei', 'local', 'select t.MANAGEDCENTERCODE,t.total,checkbody.checknum from \r\n(select MANAGEDCENTERCODE,count(1) as total from phis_chss.v_fha_person_main\r\nwhere stateid = \'1\'\r\n\r\nand status = \'1\'\r\nand MANAGEDCENTERCODE is not null\r\nand  birthday <= add_months(sysdate,-12*65)\r\ngroup by MANAGEDCENTERCODE) t\r\n\r\nleft join\r\n(select MANAGEDCENTERCODE,count(1) as checknum\r\n        from phis_chss.v_fha_person_main\r\n        where code in(\r\n        select p.code\r\n        from phis_chss.v_fha_person_main p\r\n        join phis_chss.v_fhc_check_main c\r\n        on p.code=c.code and p.stateid = \'1\' and c.stateid = \'1\'\r\n        where p.birthday <= add_months(sysdate,-12*65)\r\n        group by p.code)\r\n        and stateid = \'1\'\r\n        \r\nand status = \'1\'\r\n        and MANAGEDCENTERCODE is not null\r\n group by MANAGEDCENTERCODE ) checkbody on t.MANAGEDCENTERCODE = checkbody.MANAGEDCENTERCODE', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30004', '管理人血压控制率', 'gongwei', 'local', 'SELECT t.MANAGEDCENTERCODE,\r\n    t.total,\r\n    COALESCE ( p.reachnumber ,0) as  reachnumber\r\nFROM \r\n    (SELECT MANAGEDCENTERCODE ,\r\n    count(1) AS total\r\n    FROM phis_chss.v_fha_person_main\r\n    WHERE linkb is NOT null\r\n        AND MANAGEDCENTERCODE is NOT null\r\n        AND stateid = \'1\'\r\n        and status = \'1\'\r\n        AND code IN \r\n        (SELECT code\r\n        FROM phis_chss.v_fhc_check_main a\r\n        WHERE  a.stateid = \'1\'\r\n        GROUP BY  a.code )\r\n        GROUP BY  MANAGEDCENTERCODE) t\r\n    LEFT JOIN \r\n    (SELECT MANAGEDCENTERCODE ,\r\n    count(1) AS reachnumber\r\n    FROM phis_chss.v_fha_person_main\r\n    WHERE MANAGEDCENTERCODE is NOT null\r\n        AND stateid = \'1\'\r\n        AND code in\r\n        (SELECT code\r\n        FROM \r\n            (SELECT *\r\n            FROM \r\n                (SELECT row_number()over(partition by c.code\r\n                ORDER BY  c.examdate desc)num,c.*\r\n                FROM phis_chss.v_fhc_check_main c\r\n                LEFT JOIN phis_chss.v_fha_person_main p\r\n                  ON c.code=p.code\r\n                    AND p.stateid = \'1\'\r\n                    and p.status = \'1\'\r\n                    AND c.stateid = \'1\'\r\n                WHERE p.LINKB is NOT null\r\n                    AND p.birthday <= add_months(sysdate,-12*65)) s\r\n                WHERE num=1 )\r\n                WHERE ( ((rsbp =0\r\n                    OR rsbp is null)\r\n                    AND (RDBP =0\r\n                    OR RDBP is null)\r\n                    AND lsbp != 0\r\n                      AND ldbp != 0\r\n                    AND lsbp < 150\r\n                    AND LDBP <90)\r\n                    OR ((lsbp =0\r\n                    OR lsbp is null)\r\n                    AND (ldbp =0\r\n                    OR ldbp is null)\r\n                    AND rsbp != 0\r\n                    AND rdbp != 0\r\n                    AND RSBP < 150\r\n                    AND RDBP < 90 )\r\n                    OR ( lsbp != 0\r\n                    AND ldbp != 0\r\n                    AND lsbp < 150\r\n                    AND LDBP < 90\r\n                    AND rsbp != 0\r\n                    AND rdbp != 0\r\n                    AND RSBP < 150\r\n                    AND RDBP < 90 ) )\r\n                UNION ALL\r\n                SELECT code\r\n                FROM \r\n                    (SELECT *\r\n                    FROM \r\n                        (SELECT row_number()over(partition by c.code\r\n                        ORDER BY  c.examdate desc)num,c.*\r\n                        FROM phis_chss.v_fhc_check_main c\r\n                        LEFT JOIN phis_chss.v_fha_person_main p\r\n                          ON c.code=p.code\r\n                            AND p.stateid = \'1\'\r\n                            and p.status = \'1\'\r\n                            AND c.stateid = \'1\'\r\n                        WHERE p.LINKB is NOT null\r\n                            AND p.birthday > add_months(sysdate,-12*65)) s\r\n                        WHERE num=1 )\r\n                        WHERE ( ((rsbp =0\r\n                            OR rsbp is null)\r\n                            AND (RDBP =0\r\n                            OR RDBP is null)\r\n                            AND lsbp != 0\r\n                            AND ldbp != 0\r\n                            AND lsbp < 140\r\n                            AND LDBP < 90)\r\n                            OR ((lsbp =0\r\n                            OR lsbp is null)\r\n                            AND (ldbp =0\r\n                            OR ldbp is null)\r\n                            AND rsbp != 0\r\n                            AND rdbp != 0\r\n                            AND RSBP < 140\r\n                            AND RDBP < 90 )\r\n                            OR ( lsbp != 0\r\n                            AND ldbp != 0\r\n                            AND lsbp < 140\r\n                            AND LDBP < 90\r\n                            AND rsbp != 0\r\n                            AND rdbp != 0\r\n                            AND RSBP < 140\r\n                            AND RDBP < 90 ) ) )\r\n                        GROUP BY  MANAGEDCENTERCODE) p\r\n                      ON t.MANAGEDCENTERCODE = p.MANAGEDCENTERCODE ', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30005', '管理人群血糖控制率', 'gongwei', 'local', 'SELECT t.MANAGEDCENTERCODE,\r\n     t.total,\r\n     COALESCE ( p.sugarnumber ,0) as  sugarnumber\r\nFROM \r\n    (SELECT MANAGEDCENTERCODE,\r\n     count(1) AS total\r\n    FROM phis_chss.v_fha_person_main\r\n    WHERE linkd is NOT null\r\n        AND stateid = \'1\'\r\n        and status = \'1\'\r\n        AND MANAGEDCENTERCODE is NOT null\r\n        AND code IN \r\n        (SELECT c.code\r\n        FROM phis_chss.v_fhc_check_main c\r\n        JOIN phis_chss.v_fhc_check_attach1 ca\r\n          ON c.chid=ca.linkid\r\n            AND ca.stateid = \'1\'\r\n            AND c.stateid = \'1\'\r\n        GROUP BY  c.code )\r\n        GROUP BY  MANAGEDCENTERCODE ) t\r\n    LEFT JOIN \r\n    (SELECT MANAGEDCENTERCODE,\r\n     count(1) AS sugarnumber\r\n    FROM phis_chss.v_fha_person_main pm\r\n    JOIN phis_chss.v_fhc_check_main pc\r\n      ON pm.CODE=pc.CODE\r\n        AND pm.stateid = \'1\'\r\n        and pm.status = \'1\'\r\n        AND pc.stateid = \'1\'\r\n    WHERE pc.CHID IN \r\n        (SELECT linkid\r\n        FROM \r\n            (SELECT *\r\n            FROM \r\n                (SELECT row_number()over(partition by c.code\r\n                ORDER BY  c.examdate desc)num,ca.*\r\n                FROM phis_chss.v_fhc_check_attach1 ca\r\n                JOIN phis_chss.v_fhc_check_main c\r\n                  ON ca.LINKID=c.CHID\r\n                LEFT JOIN phis_chss.v_fha_person_main p\r\n                  ON c.code=p.code\r\n                    AND p.stateid = \'1\'\r\n                    and p.status = \'1\'\r\n                    AND c.stateid = \'1\'\r\n                WHERE p.LINKd is NOT null) s\r\n                WHERE num=1 )\r\n                WHERE fbgdl1 < 7\r\n                    AND fbgdl1 != 0 )\r\n                    AND MANAGEDCENTERCODE is NOT null\r\n                GROUP BY  MANAGEDCENTERCODE ) p\r\n              ON t.MANAGEDCENTERCODE = p.MANAGEDCENTERCODE ', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30006', '糖尿病患者和老年人可疑症状转诊率', 'gongwei', 'local', 'SELECT t.MANAGEDCENTERCODE,\r\n     t.total,\r\n     COALESCE ( p.referralnumber ,0) as  referralnumber\r\nFROM \r\n    (SELECT MANAGEDCENTERCODE,\r\n     count(1) AS total\r\n    FROM phis_chss.v_fha_person_main\r\n    WHERE code IN \r\n        (SELECT code\r\n        FROM phis_chss.v_fhd_diabetes_visit p\r\n        WHERE p.stateid = \'1\'\r\n        GROUP BY  code)\r\n            AND stateid = \'1\'\r\n            and status = \'1\'\r\n            AND MANAGEDCENTERCODE is NOT null\r\n        GROUP BY  MANAGEDCENTERCODE) t\r\n    LEFT JOIN \r\n    (SELECT MANAGEDCENTERCODE,\r\n     count(1) AS referralnumber\r\n    FROM phis_chss.v_fha_person_main\r\n    WHERE code IN \r\n        (SELECT code\r\n        FROM phis_chss.v_fhd_diabetes_visit\r\n        WHERE sftransorg=0\r\n            AND stateid = \'1\'\r\n        GROUP BY  code)\r\n            AND stateid = \'1\'\r\n            and status = \'1\'\r\n            AND MANAGEDCENTERCODE is NOT null\r\n        GROUP BY  MANAGEDCENTERCODE) p\r\n      ON t.MANAGEDCENTERCODE = p.MANAGEDCENTERCODE ', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30007', '老年人中医药健康服务覆盖率 ', 'gongwei', 'local', 'SELECT t.MANAGEDCENTERCODE,\r\n     t.total,\r\n     COALESCE ( p.guidenumber ,0) AS guidenumber\r\nFROM \r\n    (SELECT MANAGEDCENTERCODE,\r\n    count(1) AS total\r\n    FROM phis_chss.v_fha_person_main\r\n    WHERE birthday <= add_months(sysdate,-12*65)\r\n        AND stateid = \'1\'\r\n        and status = \'1\'\r\n        AND MANAGEDCENTERCODE is NOT null\r\n    GROUP BY  MANAGEDCENTERCODE) t\r\nLEFT JOIN \r\n    (SELECT MANAGEDCENTERCODE,\r\n     count(1) AS guidenumber\r\n    FROM \r\n        (SELECT pm.code,\r\n     pm.MANAGEDCENTERCODE\r\n        FROM phis_chss.v_fha_person_main pm\r\n        JOIN phis_chss.v_fhr_elder_tcm_item pt\r\n          ON pm.CODE=pt.CODE\r\n            AND pm.stateid = \'1\'\r\n            and pm.status = \'1\'\r\n            AND pt.stateid = \'1\'\r\n        JOIN phis_chss.v_fhr_elder_tcm_physique pp\r\n          ON pt.CHID=pp.LINKID\r\n            AND pt.stateid = \'1\'\r\n            AND pp.stateid = \'1\'\r\n        WHERE pm.birthday <= add_months(sysdate,-12*65)\r\n        GROUP BY  pm.code,pm.MANAGEDCENTERCODE )where MANAGEDCENTERCODE is NOT null\r\n        GROUP BY  MANAGEDCENTERCODE) p\r\n      ON t.MANAGEDCENTERCODE = p.MANAGEDCENTERCODE', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30008', '老年人健康管理率', 'gongwei', 'local', 'SELECT t.MANAGEDCENTERCODE,\r\n     t.total,\r\n     COALESCE ( p.managenumber ,0) AS managenumber\r\nFROM  \r\n   (select MANAGEDCENTERCODE,count(1) as total\r\n        from phis_chss.v_fha_person_main\r\n        where birthday\r\n        <=  add_months(sysdate,-12*65)\r\n        and stateid = \'1\'\r\n        and status = \'1\'\r\n\r\n        and MANAGEDCENTERCODE is not null\r\n        group by MANAGEDCENTERCODE) t\r\n        LEFT JOIN \r\n                (select MANAGEDCENTERCODE,count(1) as managenumber from phis_chss.v_fha_person_main\r\n        where birthday <= add_months(sysdate,-12*65)\r\n        and code in(\r\n        select pm.code from phis_chss.v_fhc_check_main pm\r\n        join phis_chss.v_fhc_check_attach1 pa on pm.CHID=pa.LINKID  AND pm.stateid = \'1\' AND pa.stateid = \'1\'\r\n        join phis_chss.v_fhr_elder_self_care pc on pm.CODE=pc.CODE  AND pm.stateid = \'1\' AND pc.stateid = \'1\'\r\n        where  (pm.exercisecode is not null or pm.EATCUSTOMCODE is not null or pm.SMOKECODE is not null or pm.drinkcode is not null or pm.WORKDISEASECODE is not null)\r\n        and (pm.heat is not null or pm.PULSE is not null or pm.BREATH is not null or pm.RSBP is not null or pm.RDBP is not null or pm.HEIGHT is not null or pm.WEIGHT is not null\r\n        or pm.WAIST is not null or pm.BMI is not null or pa.FEVERCODE is not null or pa.DENTITION is not null or pa.PHARYNGEALCODE is not null or pa.EYELEFT is not null\r\n        or pa.EYERIGHT is not null or pa.AUDITIONCODE is not null or pa.SPORTFUNCTIONCODE is not null or pa.EYEGROUNDCODE is not null or pa.SKINCODE is not null or pa.SCLERACODE is not null\r\n        or pa.SCROFULACODE is not null or pa.BUCKETCODE is not null or pa.BREATHSOUNDCODE is not null or pa.RALECODE is not null or pa.HEARTRATE is not null or pa.RHYTHMCODE is not null\r\n        or pa.SOUFFLECODE is not null or pa.TENDERNESSCODE is not null or pa.ENCLOSECODE is not null or pa.HEPATOMECODE is not null or pa.SPLENAUXECODE is not null or pa.SONANTCODE is not null\r\n        or pa.LOWEXTRECODE is not null or pa.ACROTARSIUMCODE is not null or pa.ANUSCODE is not null or pa.GALACTOPHORECODE is not null or pa.PUDENDUMCODE is not null or pa.VAGINACODE is not null\r\n        or pa.UTERUSNECKCODE is not null or pa.UTERUSBODYCODE is not null or pa.ADNEXACODE is not null)\r\n        and (pa.HEMOGLOBIN is not null or pa.WBC is not null or pa.PLATELET is not null or pa.UPROTEIN is not null or pa.GIU is not null or pa.UAB is not null or pa.HEMATURIA is not null\r\n        or pa.FBGDL1 is not null or pa.FBGDL2 is not null or pa.CARDIOGRAMCODE is not null or pa.UAA is not null or pa.FOBCODE is not null or pa.GH is not null or pa.HBSAGCODE is not null\r\n        or pa.SGPT is not null or pa.SGOT is not null or pa.ALBUMIN is not null or pa.BILIRUBIN is not null or pa.CB is not null or pa.DSC is not null or pa.BUN is not null or pa.BK is not null\r\n        or pa.BN is not null or pa.TC is not null or pa.TG is not null or pa.HDLC is not null or pa.LCLC is not null)\r\n        and (pa.INSTRUCTCODE is not null)\r\n        group by pm.CODE\r\n       )\r\n            and stateid = \'1\'\r\n            and status = \'1\'\r\n\r\n        and MANAGEDCENTERCODE is not null\r\n        group by MANAGEDCENTERCODE) p ON t.MANAGEDCENTERCODE = p.MANAGEDCENTERCODE ', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30009', '高血压患者管理率（管理数/随访数）', 'gongwei', 'local', 'SELECT\r\n  porgcode AS unitId,\r\n  reportyear AS year,\r\n  COALESCE (SUM(xj), 0) AS addNumber,\r\n  COALESCE (SUM(gf), 0) AS mangerNumber,\r\n  COALESCE (SUM(sf), 0) AS followNumber,\r\n  COALESCE (SUM(xydb), 0) as recentNumber\r\nFROM\r\n  phis_chss.v_report_year_blood\r\nWHERE\r\n  yeartype = 1\r\nGROUP BY\r\n  porgcode,\r\n  reportyear', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30010', '糖尿病患者管理率（管理数/随访数）', 'gongwei', 'local', 'SELECT\r\n  porgcode AS unitId,\r\n  reportyear AS year,\r\n  COALESCE (SUM(xj), 0) AS addNumber,\r\n  COALESCE (SUM(gf), 0) AS mangerNumber,\r\n  COALESCE (SUM(sf), 0) AS followNumber,\r\n  COALESCE (SUM(xtdb), 0) as recentNumber\r\nFROM\r\n  phis_chss.v_report_year_diabetes\r\nWHERE\r\n  yeartype = 1\r\nGROUP BY\r\n  porgcode,\r\n  reportyear', '1', null, '', '0', null, '', '19', '10', '1', '60', '', '1');
INSERT INTO `data_view` VALUES ('V30011', '档案数（按月划分）', 'gongwei', 'local', 'select  to_char(managedate,\'yyyy-mm\') as month ,count(1) as count from  phis_chss.v_fha_person_main\r\nwhere stateid=\'1\' and status=\'1\' GROUP BY to_char(managedate,\'yyyy-mm\') order by month', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V30012', '档案数（当前时间前12个月之前的档案数）', 'gongwei', 'local', 'select count(1) as count \r\nfrom phis_chss.v_fha_person_main where stateid=\'1\' and status=\'1\' and  managedate < trunc(add_months(sysdate,-12), \'mm\')', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V40000', '健康管理服务包签约率', 'gongwei', 'local', 'select t.month,t.total,zhqy.zhqys from\r\n\r\n(\r\nSELECT to_char(ps.CREATEDTIME,\'yyyy-mm\') as month, COUNT(1) as total FROM phis_chss.v_fha_person_main pm\r\nLEFT JOIN phis_chss.v_fha_person_sign_main ps ON ps.CODE=pm.CODE\r\n        where pm.status=\'1\'\r\n        AND pm.stateid = \'1\'\r\n        GROUP BY to_char( ps.CREATEDTIME,\'yyyy-mm\')\r\n\r\n)  t\r\n         join  (\r\nSELECT to_char(ps.CREATEDTIME,\'yyyy-mm\') as month, COUNT(1)  as zhqys\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE AND ps.stateid = \'0\' AND pm.stateid = \'1\'\r\n        WHERE ps.LASTFLAG = \'1\' GROUP BY to_char( ps.CREATEDTIME,\'yyyy-mm\')\r\n\r\n        ) zhqy on t.month=zhqy.month\r\n', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V40001', '昆山市第一人民医院（top10）', 'yiyuan-dyrmyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, null, '1', null, null, '1', '10', '0', '120', null, '1');
INSERT INTO `data_view` VALUES ('V40002', '昆山市中医医院（top10）', 'yiyuan-zyyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40003', '昆山市第二人民医院（top10）', 'yiyuan-dermyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40004', '昆山市第三人民医院（top10）', 'yiyuan-dsrmyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40005', '昆山市第四人民医院（top10）', 'yiyuan-ljrmyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40006', '昆山市千灯人民医院（top10）', 'yiyuan-qdrmyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40007', '昆山市第六人民医院（top10）', 'yiyuan-zprmyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40008', '昆山市花桥人民医院（top10）', 'yiyuan-zxyjhyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40009', '昆山市巴城人民医院（top10）', 'yiyuan-jswszx', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40010', '昆山市周市人民医院（top10）', 'yiyuan-zsrmyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40011', '昆山市锦溪人民医院（top10）', 'yiyuan-jxrmyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40012', '昆山市周庄人民医院（top10）', 'jcyl', 'local', ' select * from \r\n(select substr(b.diagcode,0,5)as diseasecode,a.ORGCODE as orgcode,count(1) as count from phis_webhis.v_opr_register a\r\nleft join phis_webhis.v_opm_diagnose_info b\r\non a.regid = b.regid\r\nwhere a.orgcode = \'320583107467170500\'\r\nand a.SEEDATE <= sysdate\r\nand a.SEEDATE>(sysdate-31)\r\nand b.diagcode not like \'Z%\'\r\ngroup by substr(b.diagcode,0,5),a.ORGCODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V40013', '昆山市淀山湖人民医院（top10）', 'yiyuan-dshrmyy', 'local', 'select * from \r\n(select substr(MD_DIS_CODE,0,5)as diseasecode,ORGAN_CODE as orgcode,count(1) as count from MedicalRecord\r\nwhere SEE_DOC_DT <= sysdate\r\nand SEE_DOC_DT>(sysdate-31)\r\nand MD_DIS_CODE not like \'Z%\'\r\ngroup by substr(MD_DIS_CODE,0,5),ORGAN_CODE\r\norder by count(1) desc)\r\nwhere rownum<16', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V50000', '个性化服务率', 'gongwei', 'local', 'select t.month,t.total,gxhqy.gxhqys from(\r\nSELECT to_char(pg.SIGNFROM,\'yyyy-mm\') as month, COUNT(1) as total\r\n        FROM phis_chss.v_fha_person_sign_main_org  pg\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pg.CODE=pm.CODE AND pg.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pg.signcode=\'1\' GROUP by  to_char(pg.SIGNFROM,\'yyyy-mm\')\r\n) t\r\n \r\njoin \r\n(\r\nSELECT to_char(pg.SIGNFROM,\'yyyy-mm\') as month ,COUNT(1) as gxhqys\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_sign_main_org  pg ON ps.CODE=pg.CODE AND ps.stateid = \'0\' AND pg.stateid = \'1\'\r\n        LEFT JOIN phis_chss.v_fha_person_main pm ON ps.CODE=pm.CODE AND ps.stateid = \'0\' AND pm.stateid = \'1\'\r\n        WHERE ps.guide3 is not null and pg.SIGNCODE = \'1\' and ps.LASTFLAG = \'1\' and ps.STATEID = \'0\' and ps.STATUS = \'1\'\r\n        GROUP by to_char(pg.SIGNFROM,\'yyyy-mm\')\r\n\r\n) gxhqy  on t.month=gxhqy.month', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60001', '慢病签约人员管理数', 'gongwei', 'local', '   SELECT COUNT(pg.code) as count\r\n  FROM phis_chss.v_fha_person_sign_main_org pg,\r\n       phis_chss.v_fha_person_main          pm\r\n where pg.CODE = pm.CODE\r\n   AND pg.stateid = \'1\'\r\n   AND pm.stateid = \'1\'\r\n   and pm.STATUS = \'1\'\r\n   and pg.signcode = \'1\'\r\n   and (pm.LINKB is not null or pm.LINKD is not null or\r\n       pm.LINKHEART is not null or pm.LINKBRAIN is not null)', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60002', '慢病签约人员随访数', 'gongwei', 'local', '  select count(pv.CHID) as count\r\n  from phis_chss.v_fha_person_sign_main_org pg,\r\n       phis_chss.v_fha_person_sign_visit    pv,\r\n       phis_chss.v_fha_person_main          pm\r\n where pg.CODE = pm.CODE\r\n   AND pg.stateid = \'1\'\r\n   AND pm.stateid = \'1\'\r\n   AND pg.CODE = pv.CODE\r\n   AND pg.stateid = \'1\'\r\n   AND pv.stateid = \'1\'\r\n   and pg.SIGNCODE = \'1\'\r\n   and (pm.LINKB is not null or pm.LINKD is not null or\r\n       pm.LINKHEART is not null or pm.LINKBRAIN is not null)', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60003', '上门服务人次数', 'gongwei', 'local', 'select count(1) as count from phis_chss.v_fha_person_sign_visit pv join phis_chss.v_fha_person_main pm\r\non pv.code=pm.code and pv.stateid=\'0\' and pm.stateid=\'1\' and pv.STATUS=\'1\' and pm.STATUS=\'1\' where pv.SERVERCODE=\'3\'', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60004', '营养指导人次数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit pv\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pv.CODE=pm.CODE AND pv.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pv.guide2 IS NOT NULL', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60005', '康复指导人次数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit pv\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pv.CODE=pm.CODE AND pv.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pv.guide5 IS NOT NULL', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60006', '用药指导人次数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit pv\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pv.CODE=pm.CODE AND pv.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pv.guide1 IS NOT NULL\r\n', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60007', '慢病长处方服务数', 'gongwei', 'local', '  select count(1) as count\r\n  from phis_chss.v_fha_person_main t  join phis_chss.v_fha_person_sign_visit_temp e\r\n on t.code = e.code\r\n   where e.STATEID = \'0\'\r\n   and t.STATUS = \'1\'\r\n   and t.stateid = \'1\'\r\n   and e.CCFFW is not null', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60008', '签约居民体检人数', 'gongwei', 'local', 'SELECT COUNT(1) as count FROM phis_chss.v_fha_person_main \r\n        WHERE linkcsum IS NOT NULL\r\n        AND stateid = \'1\'', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60009', '心脑血管高危人群筛查人数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit_temp  pt\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pt.CODE=pm.CODE AND pt.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pt.znxgjbsc IS NOT NULL \r\n', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60010', '肿瘤高危人群筛查数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n         FROM phis_chss.v_fha_person_sign_visit_temp  pt\r\n         JOIN phis_chss.v_fha_person_main pm\r\n        ON pt.CODE=pm.CODE AND pt.stateid = \'0\' AND pm.stateid = \'1\' and pt.STATUS=\'1\' and pm.status=\'1\'\r\n        WHERE pt.zlsc IS NOT NULL', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60011', '骨质疏松高危人群筛查数', 'gongwei', 'local', ' SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit_temp  pt\r\n         JOIN phis_chss.v_fha_person_main pm\r\n        ON pt.CODE=pm.CODE AND pt.stateid = \'0\' AND pm.stateid = \'1\' and pt.STATUS=\'1\' and pm.status=\'1\'\r\n        WHERE pt.gzsc IS NOT NULL ', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60012', 'COPD高危人群筛查数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit_temp  pt\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pt.CODE=pm.CODE AND pt.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pt.mzfsc IS NOT NULL', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60013', '儿童哮喘筛查数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit_temp  pt\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pt.CODE=pm.CODE AND pt.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pt.etxc IS NOT NULL', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60014', '健康自理检测评估数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit_temp  pt\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pt.CODE=pm.CODE AND pt.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pt.JKZDPG IS NOT NULL ', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60015', 'CDSS心脑血管风险评估数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit_temp  pt\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pt.CODE=pm.CODE AND pt.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pt.cdss IS NOT NULL', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V60016', '个性化健康信息精准推送数', 'gongwei', 'local', 'SELECT COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_visit_temp  pt\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pt.CODE=pm.CODE AND pt.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pt.wx IS NOT NULL', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V70000', '签约信息', 'gongwei', 'local', ' select * from (\r\n        SELECT  createdunitname AS signOrg,selfname as signName, gender as signGender, signperiodfrom as signDate,teamname as signTeam,familynew as signType\r\n		 from phis_chss.v_fha_person_sign_main\r\n		 where STATUS =1  and stateid =0  and LASTFLAG = \'1\' and signperiodfrom <= sysdate\r\n		 order by signperiodfrom desc\r\n        )\r\n    where  rownum<=30', '1', null, null, '0', null, null, '19', '10', '1', '60', null, '1');
INSERT INTO `data_view` VALUES ('V80001', '昆山市第一人民医院（居住地址）', 'yiyuan-dyrmyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80002', '昆山市中医医院（居住地址）', 'yiyuan-zyyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80003', '昆山市第二人民医院（居住地址）', 'yiyuan-dermyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80004', '昆山市第三人民医院（居住地址）', 'yiyuan-dsrmyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80005', '昆山市第四人民医院（居住地址）', 'yiyuan-ljrmyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80006', '昆山市千灯人民医院（居住地址）', 'yiyuan-qdrmyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80007', '昆山市第六人民医院（居住地址）', 'yiyuan-zprmyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80008', '昆山市花桥人民医院（居住地址）', 'yiyuan-zxyjhyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80009', '昆山市巴城人民医院（居住地址）', 'yiyuan-jswszx', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80010', '昆山市周市人民医院（居住地址）', 'yiyuan-zsrmyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80011', '昆山市锦溪人民医院（居住地址）', 'yiyuan-jxrmyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80012', '昆山市周庄人民医院（居住地址）', 'yiyuan-zzrmyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80013', '昆山市淀山湖人民医院（居住地址）', 'yiyuan-dshrmyy', 'local', 'select \'001\' as code,\'高新区\' as name, count(GBNAME) as count  from PersonalInformation  where  GBNAME like \'%玉山%\' or GBNAME like \'%柏庐%\' or GBNAME like \'%亭林%\' or GBNAME like \'%江浦%\' or GBNAME like \'%震川%\'\r\nunion\r\nselect \'002\' as code,\'巴城\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%巴城%\'\r\nunion\r\nselect \'003\' as code,\'花桥\' as name, count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%花桥%\'\r\nunion\r\nselect \'004\' as code,\'周市\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周市%\'\r\nunion\r\nselect \'005\' as code,\'千灯\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%千灯%\'\r\nunion\r\nselect \'006\' as code,\'陆家\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%陆家%\'\r\nunion\r\nselect \'007\' as code,\'张浦\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%张浦%\'\r\nunion\r\nselect \'008\' as code,\'周庄\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%周庄%\'\r\nunion\r\nselect \'009\' as code,\'锦溪\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%锦溪%\'\r\nunion\r\nselect \'010\' as code,\'淀山湖\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%淀山湖%\'\r\nunion\r\nselect \'011\' as code,\'开发区\' as name,count(GBNAME) as count  from PersonalInformation  where GBNAME like \'%开发区%\' or GBNAME like \'%青阳%\' or GBNAME like \'%蓬朗%\' or GBNAME like \'%震川%\'', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V80014', '基药费用按病种排名（top10)', 'yiyuan-dyrmyy', 'local', 'SELECT * FROM \r\n    (SELECT COALESCE (avg(CostRecord.TOTAL_FEE) ,\r\n    0) AS numbers ,\r\n    MedicalRecord.MD_DIS_NAME AS name\r\n    FROM WM_PrescriptionDetails\r\n    LEFT JOIN CostRecord\r\n      ON WM_PrescriptionDetails.OP_EM_HP_NO = CostRecord.OP_EM_HP_NO\r\n    LEFT JOIN MedicalRecord\r\n      ON WM_PrescriptionDetails.OP_EM_HP_NO = MedicalRecord.OP_EM_NO\r\n    WHERE    WM_PrescriptionDetails.IF_BASE_DRUG = \'1\'\r\n        AND CostRecord.TOTAL_FEE is NOT null\r\n    GROUP BY  MedicalRecord.MD_DIS_CODE,MedicalRecord.MD_DIS_NAME\r\n    ORDER BY  numbers desc)\r\nwhere rownum < 11', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
INSERT INTO `data_view` VALUES ('V90001', '应签约居民数', 'gongwei', 'local', 'SELECT managedcentercode as unit ,to_char( ps.CREATEDTIME,\'yyyy\') as year,COUNT(1)as count FROM phis_chss.v_fha_person_main pm\r\nLEFT JOIN phis_chss.v_fha_person_sign_main ps ON ps.CODE=pm.CODE\r\n        where pm.status=\'1\'\r\n         AND pm.stateid = \'1\'\r\n        GROUP BY managedcentercode ,to_char( ps.CREATEDTIME,\'yyyy\')', '1', null, null, '1', null, null, '19', '10', '0', '5', null, '1');
INSERT INTO `data_view` VALUES ('V90002', '健康管理服务包签约数(收费)', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.CREATEDTIME,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE AND ps.stateid = \'0\' AND pm.stateid = \'1\'\r\n        WHERE ps.LASTFLAG = \'1\' AND ps.FAMILYNEW = \'1\'        \r\nGROUP BY managedcentercode,to_char( ps.CREATEDTIME,\'yyyy\')', '1', null, null, '1', null, null, '19', '10', '0', '5', null, '1');
INSERT INTO `data_view` VALUES ('V90003', '健康管理服务包签约数(免费)', 'gongwei', 'local', 'SELECT managedcentercode as unit,to_char( ps.CREATEDTIME,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON ps.CODE=pm.CODE AND ps.stateid = \'0\' AND pm.stateid = \'1\'\r\n        WHERE ps.LASTFLAG = \'1\' AND ps.FAMILYNEW is null        \r\nGROUP BY managedcentercode,to_char( ps.CREATEDTIME,\'yyyy\')', '1', null, null, '1', null, null, '19', '10', '0', '5', null, '1');
INSERT INTO `data_view` VALUES ('V90004', '签约个性化服务数', 'gongwei', 'local', ' SELECT pm.managedcentercode as unit,to_char( ps.SIGNPERIODFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main ps\r\n        LEFT JOIN phis_chss.v_fha_person_sign_main_org  pg ON ps.CODE=pg.CODE AND ps.stateid = \'0\' AND pg.stateid = \'1\'\r\n        LEFT JOIN phis_chss.v_fha_person_main pm ON ps.CODE=pm.CODE AND ps.stateid = \'0\' AND pm.stateid = \'1\'\r\n        WHERE ps.guide3 is not null and pg.SIGNCODE = \'1\' and ps.LASTFLAG = \'1\' and ps.STATEID = \'0\' and ps.STATUS = \'1\'\r\n        GROUP BY pm.managedcentercode,to_char( ps.SIGNPERIODFROM,\'yyyy\')', '1', null, null, '1', null, null, '19', '10', '0', '5', null, '1');
INSERT INTO `data_view` VALUES ('V90005', '签约总数', 'gongwei', 'local', 'SELECT  pm.managedcentercode as unit,to_char( pg.SIGNFROM,\'yyyy\')as year,COUNT(1) as count\r\n        FROM phis_chss.v_fha_person_sign_main_org  pg\r\n        LEFT JOIN phis_chss.v_fha_person_main pm\r\n        ON pg.CODE=pm.CODE AND pg.stateid = \'1\' AND pm.stateid = \'1\'\r\n        WHERE pg.signcode=\'1\' \r\n        GROUP BY pm.managedcentercode,to_char(pg.SIGNFROM,\'yyyy\')', '1', null, null, '1', null, null, '19', '10', '0', '5', null, '1');
INSERT INTO `data_view` VALUES ('V90006', '职业医师（从现场执法系统查）', 'healthSupervision', 'local', 'select unique_code as unitId,count(1) as count from physician\r\nwhere unique_code in (\'320024581\',\'320024373\',\'320024301\',\'320024570\',\'320016170\',\'320011799\',\'320016169\',\'320016167\',\'320016173\',\'320016171\',\'320016172\',\'320016168\',\'320016174\')\r\nGROUP BY unique_code', '1', null, '', '1', null, '', '1', '10', '0', '120', '', '1');
