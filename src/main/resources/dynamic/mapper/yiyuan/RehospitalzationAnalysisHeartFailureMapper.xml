<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.paladin.qos.dynamic.mapper.yiyuan.RehospitalzationAnalysisHeartFailureMapper">

	<select id="getTotalNum" parameterType="Map" resultType="Long">
		select count(*) from outhospitalrecord
		<where>
			<!-- OHREC_DREC = '1' and IHD_DIS_CODE in (select major_code from classify_code_disease 
				where major_code like 'I05%' or major_code like 'I06%' or major_code like 
				'I07%' or major_code like 'I08%' or major_code like 'I09%' or major_code 
				like 'I11%' or major_code like 'I12%' or major_code like 'I13%' or major_code 
				like 'I20%' or major_code like 'I21%' or major_code like 'I22%' or major_code 
				like 'I23%' or major_code like 'I24%' or major_code like 'I25%') and IHD_DIS_CODE_1 
				in (select major_code from classify_code_disease where major_code like 'I50%') -->
			OHREC_DREC = '1'
			and IHD_DIS_CODE in ('I24.000',
			'I25.300',
			'I13.200',
			'I11.000',
			'I08.004',
			'I21.901',
			'I08.003',
			'I21.207',
			'I25.201',
			'I25.800',
			'I21.206',
			'I25.400',
			'I25.500',
			'I08.306',
			'I21.212',
			'I21.204',
			'I08.100',
			'I24.002',
			'I23.600',
			'I21.000',
			'I12.902',
			'I20.803',
			'I05.000',
			'I25.600',
			'I25.207',
			'I08.800',
			'I09.900',
			'I08.101',
			'I21.001',
			'I20.006',
			'I25.900',
			'I06.900',
			'I06.800',
			'I24.100',
			'I21.210',
			'I25.401',
			'I21.103',
			'I08.000',
			'I05.100',
			'I25.802',
			'I13.100',
			'I25.302',
			'I08.009',
			'I05.800',
			'I08.200',
			'I23.601',
			'I08.901',
			'I11.002',
			'I24.800',
			'I08.006',
			'I25.902',
			'I25.208',
			'I21.200',
			'I09.100',
			'I21.003',
			'I08.103',
			'I09.000',
			'I20.005',
			'I24.003',
			'I25.100',
			'I07.800',
			'I12.904',
			'I21.401',
			'I06.200',
			'I08.304',
			'I21.211',
			'I20.802',
			'I12.000',
			'I25.104',
			'I20.002',
			'I09.800',
			'I22.900',
			'I09.802',
			'I25.205',
			'I20.102',
			'I24.801',
			'I22.800',
			'I25.204',
			'I07.900',
			'I23.800',
			'I21.004',
			'I08.302',
			'I13.000',
			'I21.208',
			'I21.400',
			'I25.102',
			'I20.100',
			'I20.801',
			'I21.106',
			'I08.300',
			'I23.100',
			'I21.100',
			'I20.001',
			'I08.102',
			'I05.801',
			'I20.900',
			'I08.301',
			'I08.008',
			'I25.200',
			'I08.001',
			'I22.000',
			'I24.901',
			'I22.100',
			'I23.000',
			'I25.203',
			'I25.103',
			'I11.001',
			'I20.003',
			'I07.200',
			'I09.200',
			'I20.004',
			'I21.104',
			'I25.202',
			'I08.801',
			'I21.002',
			'I06.000',
			'I09.801',
			'I05.900',
			'I21.900',
			'I21.213',
			'I24.900',
			'I25.901',
			'I11.901',
			'I07.000',
			'I23.500',
			'I25.101',
			'I08.305',
			'I24.001',
			'I20.000',
			'I23.200',
			'I21.105',
			'I05.200',
			'I20.101',
			'I12.900',
			'I21.303',
			'I07.100',
			'I08.007',
			'I21.302',
			'I13.900',
			'I11.900',
			'I20.807',
			'I23.400',
			'I25.000',
			'I08.104',
			'I08.201',
			'I25.301',
			'I20.806',
			'I08.005',
			'I23.300',
			'I08.303',
			'I20.800',
			'I25.402',
			'I06.100',
			'I08.900',
			'I25.206',
			'I21.300',
			'I21.205',
			'I08.002')
			and IHD_DIS_CODE_1
			in ('I50.906',
			'I50.903',
			'I50.105',
			'I50.103',
			'I50.000',
			'I50.001',
			'I50.902',
			'I50.904',
			'I50.102',
			'I50.002',
			'I50.104',
			'I50.101',
			'I50.100',
			'I50.908',
			'I50.900',
			'I50.907',
			'I50.905')
				and OUT_HP_DT <![CDATA[>=]]>
				#{startTime}
				and OUT_HP_DT <![CDATA[<]]>
				#{endTime}
				and ORGAN_CODE = #{unitId}
		</where>
	</select>

	<select id="getEventNum" parameterType="Map" resultType="Long">
		SELECT count(*) FROM outhospitalrecord a
		where a.OHREC_DREC = '1'
		and
		a.IHD_DIS_CODE in ('I24.000',
		'I25.300',
		'I13.200',
		'I11.000',
		'I08.004',
		'I21.901',
		'I08.003',
		'I21.207',
		'I25.201',
		'I25.800',
		'I21.206',
		'I25.400',
		'I25.500',
		'I08.306',
		'I21.212',
		'I21.204',
		'I08.100',
		'I24.002',
		'I23.600',
		'I21.000',
		'I12.902',
		'I20.803',
		'I05.000',
		'I25.600',
		'I25.207',
		'I08.800',
		'I09.900',
		'I08.101',
		'I21.001',
		'I20.006',
		'I25.900',
		'I06.900',
		'I06.800',
		'I24.100',
		'I21.210',
		'I25.401',
		'I21.103',
		'I08.000',
		'I05.100',
		'I25.802',
		'I13.100',
		'I25.302',
		'I08.009',
		'I05.800',
		'I08.200',
		'I23.601',
		'I08.901',
		'I11.002',
		'I24.800',
		'I08.006',
		'I25.902',
		'I25.208',
		'I21.200',
		'I09.100',
		'I21.003',
		'I08.103',
		'I09.000',
		'I20.005',
		'I24.003',
		'I25.100',
		'I07.800',
		'I12.904',
		'I21.401',
		'I06.200',
		'I08.304',
		'I21.211',
		'I20.802',
		'I12.000',
		'I25.104',
		'I20.002',
		'I09.800',
		'I22.900',
		'I09.802',
		'I25.205',
		'I20.102',
		'I24.801',
		'I22.800',
		'I25.204',
		'I07.900',
		'I23.800',
		'I21.004',
		'I08.302',
		'I13.000',
		'I21.208',
		'I21.400',
		'I25.102',
		'I20.100',
		'I20.801',
		'I21.106',
		'I08.300',
		'I23.100',
		'I21.100',
		'I20.001',
		'I08.102',
		'I05.801',
		'I20.900',
		'I08.301',
		'I08.008',
		'I25.200',
		'I08.001',
		'I22.000',
		'I24.901',
		'I22.100',
		'I23.000',
		'I25.203',
		'I25.103',
		'I11.001',
		'I20.003',
		'I07.200',
		'I09.200',
		'I20.004',
		'I21.104',
		'I25.202',
		'I08.801',
		'I21.002',
		'I06.000',
		'I09.801',
		'I05.900',
		'I21.900',
		'I21.213',
		'I24.900',
		'I25.901',
		'I11.901',
		'I07.000',
		'I23.500',
		'I25.101',
		'I08.305',
		'I24.001',
		'I20.000',
		'I23.200',
		'I21.105',
		'I05.200',
		'I20.101',
		'I12.900',
		'I21.303',
		'I07.100',
		'I08.007',
		'I21.302',
		'I13.900',
		'I11.900',
		'I20.807',
		'I23.400',
		'I25.000',
		'I08.104',
		'I08.201',
		'I25.301',
		'I20.806',
		'I08.005',
		'I23.300',
		'I08.303',
		'I20.800',
		'I25.402',
		'I06.100',
		'I08.900',
		'I25.206',
		'I21.300',
		'I21.205',
		'I08.002')
		and a.IHD_DIS_CODE_1 in ('I50.906',
		'I50.903',
		'I50.105',
		'I50.103',
		'I50.000',
		'I50.001',
		'I50.902',
		'I50.904',
		'I50.102',
		'I50.002',
		'I50.104',
		'I50.101',
		'I50.100',
		'I50.908',
		'I50.900',
		'I50.907',
		'I50.905')
			and a.OUT_HP_DT <![CDATA[>=]]>
			#{startTime}
			and a.OUT_HP_DT <![CDATA[<]]>
			#{endTime}
			and ORGAN_CODE = #{unitId}
		AND EXISTS (
		SELECT * FROM outhospitalrecord b
		WHERE
		b.CARDNO = a.CARDNO
		AND b.OUT_HP_DT <![CDATA[!=]]>a.OUT_HP_DT
		and a.OUT_HP_DT <![CDATA[>=]]>(b.IN_HP_DT-31)
		and a.OUT_HP_DT <![CDATA[<]]>b.IN_HP_DT

		)
	</select>
</mapper>
